---
title: Parallel
date: 2020-05-16 18:45:20
tags:
- COMANDOS
- PROGRAMAÇÃO
- AUTOMAÇÃO
- LINUX
---

Para execução de scripts e programas, de forma paralela, em um sistema GNU/Linux, pode ser utilizado o [GNU Parallel]. Uma aplicação que permite distribuir a carga de procesasmento de uma ou várias aplicações em múltiplos CPUs.

### Instalação
No Ubuntu/Debian é possível fazer a instalação do seu pacote através dos reposítorios oficiais:

```sh
$ sudo apt-get get update
$ sudo apt-get install parallel
```

### Sintaxe

Executada a instalação, é possível testar
sua utilização com comandos básicos. Dentre as diversas possibilidades de utilização([man parallel]), uma das sintaxes mais simples de ser utilizada é a composição com `:::`. O trio de dois pontos consecutivos permite a indicação de comandos ou parâmetros que serão paralelizados.

No exemplo abaixo o comando `echo` será paralelizado para exibição de dois parâmetros `a` e `b` simultaneamente.

```sh
$ parallel echo ::: a b
```
O retorno dessa execução deve ser:

```sh
a
b
```

Uma segunda forma de utilizar os `:::` para criar comandos do parallel é indicando quais comandos devem ser paralelizados. Para este caso todos os parâmetros necessásios de cada comando serão inseridos num mesmo bloco, delimitado por aspas `""`.

```sh
parallel ::: "comando-1 -parametros" "comando-2 -parametros"

```
Dessa forma os comandos 1 e 2 serão executados simultaneamente, independentes se são iguais ou possuem os mesmos parâmetros.

### Exemplos

Uma forma de avaliar a execução simultânea dos comandos é mostrar o horário em que eles começaram a ser executados. Para verificar esse ponto serão utilizados em conjunto os comandos `date` e `ping`, em execuções paralelas e buscando sites distintos


Execução 1: `date`; `ping -c 3 facebook.com`

Execução 2 `date`; `ping -c 3 google.com`

```sh
parallel -k ::: "date; ping -c 3 facebook.com" "date; ping -c 3 google.com"
```
> O parâmetro `-k` serve apenas para ordenar a exibição dos resultados de cada execução. Os sites indicados são apenas para testes, poderiam ser quaisquer outros acessíveis.

O Resultado das execuções deve ser algo do tipo:

```sh
Sat May 16 19:22:37 -03 2020
PING facebook.com (31.13.85.36): 56 data bytes
64 bytes from 31.13.85.36: icmp_seq=0 ttl=49 time=22.865 ms
64 bytes from 31.13.85.36: icmp_seq=1 ttl=49 time=22.964 ms
64 bytes from 31.13.85.36: icmp_seq=2 ttl=49 time=23.001 ms
--- facebook.com ping statistics ---
3 packets transmitted, 3 packets received, 0% packet loss
round-trip min/avg/max/stddev = 22.865/22.943/23.001/0.057 ms
Sat May 16 19:22:37 -03 2020
PING google.com (172.217.29.46): 56 data bytes
64 bytes from 172.217.29.46: icmp_seq=0 ttl=43 time=24.132 ms
64 bytes from 172.217.29.46: icmp_seq=1 ttl=43 time=24.155 ms
64 bytes from 172.217.29.46: icmp_seq=2 ttl=43 time=24.048 ms
--- google.com ping statistics ---
3 packets transmitted, 3 packets received, 0% packet loss
round-trip min/avg/max/stddev = 24.048/24.112/24.155/0.046 ms
```

É importante reparar o carimbo de hora indicado, pois é justamente ele que demonstra a execução paralela de cada uma das Execuções:

```sh
Sat May 16 19:22:37 -03 2020
```


Exemplo



### Aprofundamentos

A execução paralela tem a vantagem de permitir que diferentes programas sejam iniciados em conjunto e mesmo que possuam tempo de execução distintos, as execuções não interferirão entre si.

Um exemplo oposto à paralelização é a execução em série. O seguinte comando poderia ser utilizado para realizar a mesma ação do exemplo anterior, porém os resultados não seriam iguais.

```sh
date && ping -c 3 facebook.com && date && ping -c 3 google.com
```

Resultado:

```sh
Sat May 16 20:03:08 -03 2020
PING facebook.com (157.240.222.35): 56 data bytes
64 bytes from 157.240.222.35: icmp_seq=0 ttl=49 time=14.406 ms
64 bytes from 157.240.222.35: icmp_seq=1 ttl=49 time=14.140 ms
64 bytes from 157.240.222.35: icmp_seq=2 ttl=49 time=14.014 ms
--- facebook.com ping statistics ---
3 packets transmitted, 3 packets received, 0% packet loss
round-trip min/avg/max/stddev = 14.014/14.187/14.406/0.163 ms
Sat May 16 20:03:10 -03 2020
PING google.com (172.217.29.46): 56 data bytes
64 bytes from 172.217.29.46: icmp_seq=0 ttl=43 time=25.128 ms
64 bytes from 172.217.29.46: icmp_seq=1 ttl=43 time=24.595 ms
64 bytes from 172.217.29.46: icmp_seq=2 ttl=43 time=24.572 ms
--- google.com ping statistics ---
3 packets transmitted, 3 packets received, 0% packet loss
round-trip min/avg/max/stddev = 24.572/24.765/25.128/0.257 ms
```
Repare como cada execução se deu em tempo diferente:

Execução 1: `Sat May 16 20:03:08 -03 2020`
Execução 2: `Sat May 16 20:03:10 -03 2020`

Desta forma fica demonstrada a funcionalidade e ecemplos básicos sobre como executar comandos de forma paralela com o `parallel`.



### References
- GNU Parallel: <https://www.gnu.org/software/parallel/>


[GNU Parallel]: <https://www.gnu.org/software/parallel/>

[man parallel]: <https://www.gnu.org/software/parallel/man.html>
